\frontmatter % Use roman page numbering style (i, ii, iii, iv...) for the pre-content pages

\pagestyle{plain} % Default to the plain heading style until the thesis style is called for the body content

%----------------------------------------------------------------------------------------
%	TITLE PAGE
%----------------------------------------------------------------------------------------

\begin{titlepage}
\begin{center}

\vspace*{.06\textheight}
{\scshape\LARGE \univname\par}\vspace{1.5cm} % University name
\textsc{\Large Doctoral Thesis}\\[0.5cm] % Thesis type

\HRule \\[0.4cm] % Horizontal line
{\huge \bfseries \ttitle\par}\vspace{0.4cm} % Thesis title
\HRule \\[1.5cm] % Horizontal line
 
\begin{minipage}[t]{0.4\textwidth}
\begin{flushleft} \large
\emph{Author:}\\
\href{https://s-tikhomirov.github.io/about/}{\authorname} % Author name - remove the \href bracket to remove the link
\end{flushleft}
\end{minipage}
\begin{minipage}[t]{0.4\textwidth}
\begin{flushright} \large
\emph{Supervisor:} \\
\href{https://www.cryptolux.org/index.php/Alex\_Biryukov}{\supname} % Supervisor name - remove the \href bracket to remove the link  
\end{flushright}
\end{minipage}\\[3cm]
 
\vfill

\large \textit{A thesis submitted in fulfillment of the requirements\\ for the degree of \degreename}\\[0.3cm] % University requirement text
\textit{in the}\\[0.4cm]
\groupname\\\deptname\\[2cm] % Research group name and department name
 
\vfill

{\large \today}\\[4cm] % Date
%\includegraphics{Logo} % University/department logo - uncomment to place it
 
\vfill
\end{center}
\end{titlepage}


\cleardoublepage

%----------------------------------------------------------------------------------------
%	QUOTATION PAGE
%----------------------------------------------------------------------------------------

\vspace*{0.2\textheight}

\noindent\enquote{\itshape 
	Imagine there was a base metal as scarce as gold but with the following properties:
	\begin{itemize}
	\item[--] boring grey in colour
	
	\item[--] not a good conductor of electricity
	
	\item[--] not particularly strong, but not ductile or easily malleable either
	
	\item[--] not useful for any practical or ornamental purpose 
	\end{itemize}
	and one special, magical property: can be transported over a communications channel.}\bigbreak
\hfill Satoshi Nakamoto
% https://bitcointalk.org/index.php?topic=583.msg11405#msg11405

%----------------------------------------------------------------------------------------
%	ABSTRACT PAGE
%----------------------------------------------------------------------------------------

\begin{abstract}
\addchaptertocentry{\abstractname} % Add the abstract to the table of contents

Bitcoin is the first digital currency without a trusted third party.
This revolutionary protocol allows mutually distrusting participants to agree on a single common history of transactions.
Bitcoin nodes pack transactions into blocks and link those in a chain (the \textit{blockchain}).
Hash-based \textit{proof-of-work} ensures that the blockchain is computationally infeasible to modify.

Bitcoin has spawned a new area of research at the intersection of computer science and economics.
Multiple alternative \textit{cryptocurrencies} and blockchain projects aim to address Bitcoin's limitations.
This thesis explores the security and privacy of blockchain systems.

In Part~\ref{Part1Privacy}, we study the privacy of Bitcoin and the major privacy-focused cryptocurrencies.
In Chapter~\ref{Chapter02IntroP2P}, we explore the peer-to-peer (P2P) protocols underpinning cryptocurrencies.
In Chapter~\ref{Chapter03Clustering}, we show how a network adversary can link transactions issued by the same node.
We test the efficiency of this novel attack in real networks, successfully linking our own transactions.
Chapter~\ref{Chapter04Wallets} studies the privacy characteristics of mobile cryptocurrency wallets.
We discover that most wallets do not follow the best practices aimed at protecting users' privacy.

Part~\ref{Part2Lightning} is dedicated to the Lightning Network (LN).
Bitcoin's architecture emphasizes security but severely limits transaction throughput.
LN is a prominent Bitcoin-based protocol that aims to alleviate this issue.
LN performs low-latency transactions \textit{off-chain} but leverages Bitcoin's security guarantees for dispute resolution.
We introduce the LN and outline the history of off-chain protocols in Chapter~\ref{Chapter05IntroLightning}.
Then, in Chapter~\ref{Chapter06LNprobing}, we introduce a probing attack that allows an adversary to discover user balances in the LN\@.
Chapter~\ref{Chapter07LNattacks} estimates the likelihood of various privacy attacks on the LN\@.
In Chapter~\ref{Chapter08HTLClimit}, we describe a limitation on the number of concurrent LN payments and quantify its effects on transaction throughput.

Part~\ref{Part3Ethereum} explores the security and privacy of Ethereum smart contracts.
Bitcoin's language for defining spending conditions is intentionally restricted.
Ethereum is a blockchain network allowing for more programmability.
Ethereum users can write programs in a Turing-complete high-level language called Solidity.
These programs, called \textit{smart contracts}, are stored on-chain along with their state.
Chapter~\ref{Chapter09Introcontracts} outlines the history of blockchain-based programming.
Chapter~\ref{Chapter10Findel} describes Findel -- a Solidity-based declarative domain-specific language for financial contracts.
In Chapter~\ref{Chapter11SmartCheck}, we classify the vulnerabilities in real-world Ethereum contracts.
We then present SmartCheck -- a static analysis tool for bug detection in Solidity programs.
Finally, Chapter~\ref{Chapter12KYC} introduces an Ethereum-based cryptographic protocol for privacy-preserving regulation compliance.

\end{abstract}

%----------------------------------------------------------------------------------------
%	ACKNOWLEDGEMENTS
%----------------------------------------------------------------------------------------

\begin{acknowledgements}
\addchaptertocentry{\acknowledgementname} % Add the acknowledgements to the table of contents
This work would not be possible without the help and support of many people.
This is an incomplete list of those to whom I would like to express my gratitude.

First of all, I am deeply grateful to my advisor, Prof.~Alex~Biryukov, for the opportunity to pursue my research interests and the invaluable guidance throughout this journey.
I appreciate Prof.~Volker M{\"u}ller, A-Prof.~Andrew Miller, Prof.~Matteo Maffei, Dr.~Patrick McCorry, and A-Prof.~Arthur Gervais agreeing to serve as jury members.
I thank my co-authors: Dmitry Khovratovich, Ekaterina Voskresenskaya, Ivan Ivanitskiy, Ramil Takhaviev, Evgeny Marchenko, Yaroslav Alexandrov, Pedro Moreno-Sanchez, Matteo Maffei, Ren{\'e} Pickhardt, and Mariusz Nowostawski.
I have learned a lot during our fruitful collaborations.
A special thanks goes to Pedro Moreno-Sanchez and Matteo Maffei for inviting me to spend three months on a research visit at TU~Wien in the beautiful city of Vienna.

I thank my colleagues for the insightful and fun conversations: Aleksei Udovenko, Brian Shaft, Christof Beierle, Dag Arne Osvik, Daniel Dinu, Daniel Feher, Dmitry Khovratovich, Giuseppe Vitto, Johann Gro{\ss}sch{\"a}dl, Luan Cardoso dos Santos, L{\'e}o Perrin, Qingju Wang, Ritam Bhaumik, Shange Fu, Vesselin Velichkov, and Yann Le Corre.

The country of Luxembourg and the University of Luxembourg generously provided me with excellent research conditions.
I specifically thank Fabienne Schmitz, Ida Ienna, and Catherine Violet for their assistance in administrative matters.

A huge thanks goes to my co-hosts for the Basic Block Radio podcast Ivan Ivanitskiy, Sergei Pavlin, and Alexander Seleznev, and to all our guests and listeners, for helping spread the word about decentralized technologies for the Russian-speaking audience.

My deepest gratitude goes to my family for their endless love and support.
I want to specifically thank my parents for encouraging me to pursue education abroad.

Finally, I thank Satoshi Nakamoto.
Your ingenious invention continues to amaze and inspire me.
I admire your wisdom and humility.
It is an honor to be a part of the movement you started.

\end{acknowledgements}

%----------------------------------------------------------------------------------------
%	LIST OF CONTENTS/FIGURES/TABLES PAGES
%----------------------------------------------------------------------------------------

\tableofcontents % Prints the main table of contents

\listoffigures % Prints the list of figures

\listoftables % Prints the list of tables

%----------------------------------------------------------------------------------------
%	ABBREVIATIONS
%----------------------------------------------------------------------------------------

\begin{abbreviations}{ll} % Include a list of abbreviations (a table of two columns)

\textbf{AMHL} & Anonymous multi-hop lock \\
\textbf{AML} & Anti money laundering \\
\textbf{ANTLR} & Another tool for language recognition \\
\textbf{API} & Application programming interface \\
\textbf{APK} & Android package \\
\textbf{ARPANET} & Advanced research projects agency network \\
\textbf{ASIC} & Application-specific integrated circuit \\
\textbf{AST} & Abstract syntax tree \\
\textbf{BFT} & Byzantine fault tolerant \\
\textbf{BIP} & Bitcoin improvement proposal \\
\textbf{BOLT} & Basics of Lightning technology \\
\textbf{BTC} & Bitcoin (a currency unit) \\
\textbf{CA} & Certificate authority \\
\textbf{CEI} & Checks-effects-interactions \\
\textbf{CLTV} & Checklocktimeverify \\
\textbf{CPU} & Central processing unit \\
\textbf{CTF} & Counter terrorist financing \\
\textbf{DAO} & Decentralized autonomous organization \\
\textbf{DHT} & Distributed hash table \\
\textbf{DMC} & Duplex micropayment channels \\
\textbf{DNS} & Domain name system \\
\textbf{DoS} & Denial of service \\
\textbf{DSL} & Domain-specific language \\
\textbf{ECDSA} & Elliptic curve digital signature algorithm \\
\textbf{EU} & European Union \\
\textbf{EVM} & Ethereum virtual machine \\
\textbf{FDR} & False discovery rate \\
\textbf{FNR} & False negative rate \\
\textbf{FN} & False negative \\
\textbf{FPGA} & Field-programmable gate array \\
\textbf{FP} & False positive \\
\textbf{FTP} & File transfer protocol \\
\textbf{GDPR} & General data protection regulation \\
\textbf{GHOST} & Greedy heaviest-observed sub-tree \\
\textbf{GPU} & Graphics processing unit \\
\textbf{GUI} & Graphical user interface \\
\textbf{HTLC} & Hash time-locked contract \\
\textbf{HTTPS} & Hypertext transfer protocol secure \\
\textbf{HTTP} & Hypertext transfer protocol \\
\textbf{IBD} & Initial block download \\
\textbf{ICO} & Initial coin offering \\
\textbf{ID} & Identifier \\
\textbf{IP} & Internet protocol \\
\textbf{IR} & Intermediate representation \\
\textbf{ISP} & Internet service provider \\
\textbf{JIT} & Just in time \\
\textbf{JSON} & JavaScript object notation \\
\textbf{KYC} & Know your customer \\
\textbf{LN} & Lightning network \\
\textbf{MPP} & Multi-part payment \\
\textbf{NAT} & Network address translation \\
\textbf{NFC} & Near-field communication \\
\textbf{P2P} & Peer-to-peer \\
\textbf{PBFT} & Practical Byzantine fault tolerance \\
\textbf{PKI} & Public key infrastructure \\
\textbf{PoS} & Proof of stake \\
\textbf{PoW} & Proof of work \\
\textbf{PSD} & Payment service directive \\
\textbf{QR} & Quick response \\
\textbf{RAM} & Random-access memory \\
\textbf{RPC} & Remote procedure call \\
\textbf{SEC} & Securities and exchange commission \\
\textbf{SHA} & Secure hash algorithm \\
\textbf{SMS} & Short message service \\
\textbf{SPV} & Simplified payment verification \\
\textbf{TCP} & Transmission control protocol \\
\textbf{TLS} & Transport layer security \\
\textbf{TN} & True negative \\
\textbf{TP} & True positive \\
\textbf{URL} & Uniform resource locator \\
\textbf{USD} & United States dollar \\
\textbf{US} & United States \\
\textbf{UTXO} & Unspent transaction output \\
\textbf{XML} & Extensible markup language \\
\textbf{XSS} & Cross-site scripting \\
\textbf{zk-SNARK} & Zero-knowledge succinct non-interactive argument of knowledge \\

\end{abbreviations}


%----------------------------------------------------------------------------------------
%	DEDICATION
%----------------------------------------------------------------------------------------

%\dedicatory{For/Dedicated to/To my\ldots} 